var client;$(function(){"use strict";function n(n,e,t,i){console.log(n+": %c"+i+" -> "+e,"color:green;font-weight:bold","Reason: ",t)}Skype.initialize({apiKey:config.apiKey},function(n){client=new n.application,client.signInManager.state.changed(function(n){console.log(n)})},function(n){console.log(n),alert("Cannot load the SDK.")}),$("#name, #meetingUri").keypress(function(n){13===n.keyCode&&(n.preventDefault(),$("#signin").click())}),$("#signin").click(function(){client.signInManager.signIn({version:config.version,name:$("#name").val(),origins:["https://webdir.online.lync.com/autodiscover/autodiscoverservice.svc/root"],meeting:$("#meetingUri").val(),cors:!0}).then(function(){console.log("Signed in as: "+client.personsAndGroupsManager.mePerson.displayName()),$("#sign-in").addClass("disable");client.conversationsManager.conversations.added(function(e){var t,i,a;t=e.chatService,i=e.audioService,a=e.videoService,e.participants.added(function(e){e.video.state.changed(function(t,i,a){n("_participant.video.state",t,i,a),"Connected"===t&&(e.video.channels(0).stream.state.changed(function(e,t,i){n("_participant.video.channels(0).stream.state",e,t,i)}),setTimeout(function(){e.video.channels(0).stream.source.sink.container.set(document.getElementById("renderWindow")).then(function(){setTimeout(function(){e.video.channels(0).isStarted(!0)},0)})},6e3))}),e.audio.state.changed(function(e,t,i){n("_participant.audio.state",e,t,i)})}),e.selfParticipant.audio.state.changed(function(e,t,i){n("selfParticipant.audio.state",e,t,i)}),e.selfParticipant.video.state.changed(function(t,i,a){var o;n("selfParticipant.video.state",t,i,a),"Connected"===t&&(o=e.selfParticipant.video.channels(0),o.stream.source.sink.container.set(document.getElementById("previewWindow")).then(function(){o.isStarted(!0)}))})})},function(n){console.error(n),alert(n||"Cannot sign in")})}),$("#startChatMeeting").click(function(){var n,e,t=$("#meetingUri").text();n=client.conversationsManager.getConversationByUri(t),e=n.chatService.start().then(function(){n.chatService.sendMessage("Hi")})}),$("#startAudioMeeting").click(function(){var n,e,t=$("#meetingUri").text();n=client.conversationsManager.getConversationByUri(t),e=n.audioService.start()}),$("#startVideoMeeting").click(function(){var n,e,t=$("#meetingUri").text();n=client.conversationsManager.getConversationByUri(t),e=n.videoService.start()}),$("#end").click(function(){var n,e=client.conversationsManager.conversations(0);e&&(n=e.leave(),n.then(function(){client.conversationsManager.conversations.remove(e),window.location.reload()}))}),$("#signout").click(function(){client.signInManager.signOut().then(function(){alert("Signed out")},function(n){alert(n||"Cannot sign out")})})});